create procedure sp_ssrs_ReputationTrendingPeriods (	@Server nvarchar(200),	@Database nvarchar(200))as/*declare@Server nvarchar(200),@Database nvarchar(200)select@Server = 'DEV',@Database = 'Rothman'exec sp_ssrs_ReputationTrendingPeriods @Server, @Database*/declare@CustomerID nvarchar(50),@CustomerSource nvarchar(120),@sql nvarchar(max),@parms nvarchar(max),@CR char(1)set @CR = char(13)select @Server = String from ScriptBox.dbo.Servers where Label = @Serverset @sql = 'select top 1 @TempCustomerSource = CustomerSource, @TempCustomerID = CustomerID ' + @CRset @sql = @sql + 'from ' + @Database + '.dbo.PhysCustomerID'set @parms = '@TempCustomerSource varchar(120) output, @TempCustomerID nvarchar(50) output'exec sp_executesql @sql, @parms, @TempCustomerSource = @CustomerSource output, @TempCustomerID = @CustomerID output/*set @sql = ' ' + @CRset @sql = @sql + ' ' + @CRexec(@sql)
*/

set @sql = 'select distinct StartDate + '' - '' + EndDate as Period ' + @CRset @sql = @sql + 'from [' + @Server + '].[' + @Database + '].dbo.PhysVRepTrendMedia ' + @CRset @sql = @sql + 'order by Period desc ' + @CRexec(@sql)